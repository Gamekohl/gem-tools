<div class="mx-auto max-w-6xl p-6 lg:p-10">
    <div class="flex items-start justify-between gap-6">
        <div>
            <h1 class="text-2xl font-semibold tracking-tight">Resources</h1>
            <p class="mt-1 text-sm text-slate-500">
                Browse through resources provided by Call to Arms - Gates Of Hell.
            </p>
        </div>

        <form [formGroup]="form" class="flex items-center gap-3">
            <input
                    class="w-64 rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-slate-300"
                    placeholder="Search resources..."
                    id="search"
                    formControlName="search"
            />
        </form>
    </div>

    <section class="mt-8 rounded-2xl border border-slate-200 bg-white overflow-hidden">
        <div class="px-4 py-3 border-b border-slate-200 flex items-center justify-end gap-4">
            <div class="text-xs text-slate-500">
                @if (searchControl.value.length) {
                    Filtered by: <span class="font-medium text-slate-700">{{ searchControl.value }}</span>
                } @else {
                    Showing all resources
                }
            </div>
        </div>

        <div class="max-h-[70vh] overflow-auto">
            <app-preview-image [resolveUrl]="resolvePreviewUrl"></app-preview-image>

            <mat-tree
                #tree
                class="overflow-hidden"
                [dataSource]="dataSource"
                [childrenAccessor]="childrenAccessor"
            >
                <mat-tree-node
                        (mouseenter)="openPreview(nodeElement, node)"
                        (mouseleave)="closePreview()"
                        (click)="copyName(node.name)"
                        class="group w-full hover:font-semibold! flex gap-2 items-center cursor-pointer p-4 border-b border-b-slate-200 hover:bg-slate-100 last:border-b-0"
                        *matTreeNodeDef="let node"
                        matTreeNodePadding
                        matTreeNodeToggle
                        #nodeElement
                >
                    <ng-icon name="tablerBox"></ng-icon>
                    <span [innerHTML]="getText(node.name)" class="flex-1"></span>
                    <ng-icon name="tablerCopy" class="hidden! group-hover:inline-block! transition-all"></ng-icon>
                </mat-tree-node>

                <mat-tree-node
                        [attr.data-node]="tree.isExpanded(node) ? node.name : ''"
                        class="tree-node w-full items-center cursor-pointer p-4 border-b border-b-slate-200 last:border-b-0 hover:bg-slate-100 transition-colors"
                        *matTreeNodeDef="let node;when: hasChild"
                        matTreeNodePadding
                        matTreeNodeToggle
                >
                    <button class="p-2 flex items-center" matTreeNodeToggle
                            [attr.aria-label]="'Toggle ' + node.name">
                        <ng-icon [name]="tree.isExpanded(node) ? 'tablerFolderOpen' : 'tablerFolder'"></ng-icon>
                    </button>
                    <span [class.font-bold]="tree.isExpanded(node)" [innerHTML]="getText(node.name)"
                          class="cursor-pointer">
                          {{ node.name }}
                        </span>
                </mat-tree-node>
            </mat-tree>
        </div>
    </section>
</div>
